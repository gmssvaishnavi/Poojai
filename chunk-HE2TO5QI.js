import{a as V}from"./chunk-GPY7EN6I.js";import{$a as M,Cb as F,Ma as _,Na as x,Oa as k,Pa as b,Q as S,Qa as y,Ra as E,Sa as s,Ta as a,V as P,Va as z,W as T,Wa as h,Xa as m,a as u,aa as f,ab as L,b as v,bb as d,cb as C,fb as O,oa as l,qb as I,ya as w}from"./chunk-DKZNZJOI.js";var $=(n,o)=>o.title;function R(n,o){n&1&&(s(0,"div",4),d(1,"Loading songs..."),a())}function j(n,o){if(n&1&&(s(0,"div",5),d(1),a()),n&2){let r=m();l(),C(r.mediaService.error())}}function H(n,o){if(n&1&&(s(0,"p"),d(1),a()),n&2){let r=o.$implicit;L(r.type),l(),C(r.text)}}function D(n,o){if(n&1&&(s(0,"div",12),b(1,H,2,3,"p",14,k),a()),n&2){let r=m(2).$implicit,e=m(2);l(),y(e.formatLyrics(e.songContents()[r.title]))}}function A(n,o){n&1&&(s(0,"div",13),d(1,"Loading lyrics..."),a())}function B(n,o){if(n&1&&(s(0,"div",11),_(1,D,3,0,"div",12)(2,A,2,0,"div",13),a()),n&2){let r=m().$implicit,e=m(2);l(),x(e.songContents()[r.title]?1:2)}}function N(n,o){if(n&1){let r=z();s(0,"div",7)(1,"div",9),h("click",function(){let t=P(r).$implicit,i=m(2);return T(i.toggleSong(t.title))}),s(2,"h3"),d(3),a(),s(4,"span",10),d(5," \u25B6 "),a()(),_(6,B,3,1,"div",11),a()}if(n&2){let r=o.$implicit,e=m(2);l(3),C(r.title),l(),M("expanded",e.expandedSongs().has(r.title)),l(2),x(e.expandedSongs().has(r.title)?6:-1)}}function G(n,o){n&1&&(s(0,"div",8)(1,"p"),d(2,"No songs found for your search."),a()())}function J(n,o){if(n&1&&(s(0,"div",6),b(1,N,7,4,"div",7,$,!1,G,3,0,"div",8),a()),n&2){let r=m();l(),y(r.filteredTextItems())}}var X=(()=>{let o=class o{constructor(){this.mediaService=S(V),this.http=S(I),this.expandedSongs=f(new Set),this.songContents=f({}),this.loadingContent=f(!1),this.searchTerm=f(""),this.isListening=f(!1),this.textItems=O(()=>this.mediaService.mediaItems().filter(e=>e.type==="text")),this.filteredTextItems=O(()=>{let e=this.searchTerm().toLowerCase();return this.textItems().filter(t=>t.title.toLowerCase().includes(e))})}ngOnInit(){this.mediaService.fetchMedia()}onSearchInput(e){let t=e.target;this.searchTerm.set(t.value)}toggleVoiceSearch(){this.isListening()?this.stopVoiceSearch():this.startVoiceSearch()}startVoiceSearch(){if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){let e=window.webkitSpeechRecognition||window.SpeechRecognition,t=new e;t.continuous=!1,t.interimResults=!1,t.lang="en-US",t.onstart=()=>this.isListening.set(!0),t.onend=()=>this.isListening.set(!1),t.onresult=i=>{let g=i.results[0][0].transcript;this.searchTerm.set(g)},t.start()}}stopVoiceSearch(){this.isListening.set(!1)}toggleSong(e){let t=new Set(this.expandedSongs());t.has(e)?t.delete(e):(t.add(e),this.loadSongContent(e)),this.expandedSongs.set(t)}loadSongContent(e){let t=this.textItems().find(i=>i.title===e);!t||this.songContents()[e]||(this.loadingContent.set(!0),this.http.get(t.url,{responseType:"text"}).subscribe({next:i=>{this.songContents.update(g=>v(u({},g),{[e]:i})),this.loadingContent.set(!1)},error:()=>{this.songContents.update(i=>v(u({},i),{[e]:"Failed to load content"})),this.loadingContent.set(!1)}}))}formatLyrics(e){if(!e)return[];let t=this.decodeHtml(e),i=t.match(/\{\s*\d+\s*,\s*"([^"]+)"\s*\}/g);if(i)return i.map(c=>{let p=c.match(/\{\s*(\d+)\s*,\s*"([^"]+)"\s*\}/);return p?{text:`${p[1]}. ${p[2]}`,type:"line"}:{text:"",type:"empty"}});let g=t;try{let c=JSON.parse(t);c&&typeof c=="object"&&c.song&&(g=Array.isArray(c.song)?c.song.join(`
`):c.song)}catch{}return g.split(`
`).map(c=>{let p=c.trim();return p===""?{text:"",type:"empty"}:/^\d+\./.test(p)?{text:p,type:"stanza-header"}:{text:p,type:"line"}})}decodeHtml(e){let t=document.createElement("textarea");return t.innerHTML=e,t.value}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=w({type:o,selectors:[["app-text"]],decls:10,vars:4,consts:[[1,"text-container"],[1,"search-container"],["type","text","placeholder","Search for a song...",1,"search-input",3,"input","value"],["title","Voice Search",1,"voice-btn",3,"click"],[1,"loading"],[1,"error"],[1,"songs-list"],[1,"song-card"],[1,"no-results"],[1,"song-header",3,"click"],[1,"toggle-icon"],[1,"song-content"],[1,"lyrics"],[1,"loading-song"],[3,"class"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"h2"),d(2,"Songs & Lyrics"),a(),s(3,"div",1)(4,"input",2),h("input",function(c){return i.onSearchInput(c)}),a(),s(5,"button",3),h("click",function(){return i.toggleVoiceSearch()}),d(6," \u{1F3A4} "),a()(),_(7,R,2,0,"div",4)(8,j,2,1,"div",5)(9,J,4,1,"div",6),a()),t&2&&(l(4),E("value",i.searchTerm()),l(),M("listening",i.isListening()),l(2),x(i.mediaService.loading()||i.loadingContent()?7:i.mediaService.error()?8:9))},dependencies:[F],styles:["[_nghost-%COMP%]{display:block;font-family:Helvetica Neue,sans-serif;background-color:#f4f7f6}.text-container[_ngcontent-%COMP%]{padding:2rem;max-width:800px;margin:2rem auto;background:transparent}.search-container[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:2rem;justify-content:center}.search-input[_ngcontent-%COMP%]{padding:.75rem 1rem;border:2px solid #ddd;border-radius:25px;font-size:1rem;width:300px;outline:none}.search-input[_ngcontent-%COMP%]:focus{border-color:#8b4513}.voice-btn[_ngcontent-%COMP%]{padding:.75rem 1rem;border:2px solid #8B4513;border-radius:50%;background:#fff;cursor:pointer;font-size:1.2rem;transition:all .3s ease}.voice-btn[_ngcontent-%COMP%]:hover{background:#8b4513}.voice-btn.listening[_ngcontent-%COMP%]{background:#f44;animation:_ngcontent-%COMP%_pulse 1s infinite}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1)}50%{transform:scale(1.1)}to{transform:scale(1)}}h2[_ngcontent-%COMP%]{text-align:center;color:#2c3e50;margin-bottom:2.5rem;font-size:2.8rem;font-weight:300;letter-spacing:-1px}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%]{text-align:center;padding:3rem 2rem;font-size:1.2rem;color:#7f8c8d;background-color:#fff;border-radius:12px;box-shadow:0 2px 10px #0000000d}.error[_ngcontent-%COMP%]{color:#e74c3c}.songs-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem}.song-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;box-shadow:0 4px 12px #00000014;overflow:hidden;transition:all .4s cubic-bezier(.25,.8,.25,1);border:1px solid #eef}.song-card[_ngcontent-%COMP%]:hover{box-shadow:0 8px 25px #0000001f;transform:translateY(-2px)}.song-header[_ngcontent-%COMP%]{padding:1.5rem 2rem;background:linear-gradient(135deg,#27ae60,#2ecc71);color:#fff;cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:background-color .3s ease}.song-header[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#229954,#28b463)}.song-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.4rem;font-weight:500}.toggle-icon[_ngcontent-%COMP%]{font-size:1.2rem;transition:transform .4s cubic-bezier(.25,.8,.25,1);transform-origin:center;color:#fffc}.toggle-icon.expanded[_ngcontent-%COMP%]{transform:rotate(90deg);color:#fff}.song-content[_ngcontent-%COMP%]{padding:2.5rem;background:#fafcff;border-top:1px solid #eef}.lyrics[_ngcontent-%COMP%]{font-family:Georgia,serif;line-height:1.9;color:#34495e}.lyrics[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0}.lyrics[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.6rem;font-weight:700;text-align:center;margin-bottom:2rem;color:#2c3e50}.lyrics[_ngcontent-%COMP%]   .stanza-header[_ngcontent-%COMP%]{font-weight:700;margin-top:1.5rem;color:#2c3e50;font-size:1.2rem}.lyrics[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{font-size:1.15rem;margin-left:1.5rem;line-height:2}.lyrics[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{height:1.2rem}.loading-song[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#95a5a6;font-style:italic;font-size:1.1rem}"]});let n=o;return n})();export{X as TextComponent};
